public with sharing class ReservationSubmitController {
    @AuraEnabled
    public static void createFinalReservationCase(
        Id accountId,
        Id repairShopId,
        String preferredDate,
        String selectedDetails,
        String description
    ) {
        System.debug('ğŸ“¥ [createFinalReservationCase í˜¸ì¶œë¨]');
        System.debug('â¡ï¸ accountId: ' + accountId);
        System.debug('â¡ï¸ repairShopId: ' + repairShopId);
        System.debug('â¡ï¸ preferredDate: ' + preferredDate);
        System.debug('â¡ï¸ selectedDetails: ' + selectedDetails);
        System.debug('â¡ï¸ description: ' + description);

        DateTime parsedDate;
        try {
            parsedDate = DateTime.valueOf(preferredDate);
        } catch (Exception e) {
            System.debug('âŒ preferredDate ë³€í™˜ ì‹¤íŒ¨: ' + e.getMessage());
            throw new AuraHandledException('ë‚ ì§œ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        Case newCase = new Case(
            AccountId = accountId,
            Repair_Shop__c = repairShopId,
            Preferred_Date__c = parsedDate,
            ServiceReservationTypeDetails__c = selectedDetails,
            Description = description
        );

        System.debug('ğŸ§¾ Case ì¤€ë¹„ ì™„ë£Œ: ' + JSON.serialize(newCase));

        try {
            insert newCase;
            System.debug('âœ… Case ìƒì„± ì„±ê³µ');
        } catch (DmlException e) {
            System.debug('âŒ DML ì‹¤íŒ¨: ' + e.getDmlMessage(0));
            System.debug('â— ì „ì²´ ì˜¤ë¥˜: ' + e.getMessage());
            throw new AuraHandledException('Case ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + e.getDmlMessage(0));
        }
    }
}